const canvas=document.querySelector(".photo"),ctx=canvas.getContext("2d"),video=document.querySelector(".player"),strip=document.querySelector(".strip"),snap=document.querySelector(".snap");function getVideo(){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(localMediaStream){video.srcObject=localMediaStream,video.play()}).catch(function(err){console.error("OH NO!!!",err)})}function paintToCanvas(){const width=video.videoWidth,height=video.videoHeight;return canvas.width=width,canvas.height=height,setInterval(function(){ctx.drawImage(video,0,0,width,height);let pixels=ctx.getImageData(0,0,width,height);pixels=greenScreen(pixels),ctx.putImageData(pixels,0,0)},16)}function takePhoto(){snap.currentTime=0,snap.play();const data=canvas.toDataURL("image/jpeg"),link=document.createElement("a");link.href=data,link.innerHTML=`<img src="${data}" alt="cool">`,strip.insertBefore(link,strip.firstChild)}function redEffect(pixels){for(let i=0;i<pixels.data.length;i+=4)pixels.data[i+0]=pixels.data[i+0]+100,pixels.data[i+1]=pixels.data[i+1]-50,pixels.data[i+2]=.5*pixels.data[i+2];return pixels}function rgbSplit(pixels){for(let i=0;i<pixels.data.length;i+=4)pixels.data[i-150]=pixels.data[i+0],pixels.data[i+500]=pixels.data[i+1],pixels.data[i-550]=pixels.data[i+2];return pixels}function greenScreen(pixels){const levels={};for(document.querySelectorAll(".rgb input").forEach(function(input){levels[input.name]=input.value}),i=0;i<pixels.data.length;i+=4)red=pixels.data[i+0],green=pixels.data[i+1],blue=pixels.data[i+2],alpha=pixels.data[i+3],red>=levels.rmin&&green>=levels.gmin&&blue>=levels.bmin&&red<=levels.rmax&&green<=levels.gmax&&blue<=levels.bmax&&(pixels.data[i+3]=0);return pixels}getVideo(),video.addEventListener("canplay",paintToCanvas);